%{
#include "sslcommon.h"
%}

parserinclude ssl2 ssl2 ;

token uint8start = "\x16" ;
token uint16any = "..?" ;
token uint16versaccept = "\x03[\x01\x02\x03]" ;

tlsmsg = 
uint8start tlsversdata
;

tlsversdata = 
uint16versaccept tlsdata
;

tlsdata = 
uint16any<cb=szbe1> bytes<cb=feed1>
;

directive bytessizetype = uint16_t ;
directive main = tlsmsg ;
directive parsername = ssl1 ;
